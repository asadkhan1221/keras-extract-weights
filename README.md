## Keras Extract Weights from Model to CSV file

Utilities for working with Keras models

1.  extract_parameters.py

- Takes Keras h5py model parameter file and outputs a csv file with model parameters per layer
- extract_parameters.py --h5_path='file_path' --CSV_path='file_path'

--------------------
Each Keras layer has a group that has members:  1 for the biases and 1 for the parameters of the layer.

The biases are output first and then the parameters.  Each bias/parameter, layer combination is appended to a list for that layer and output to a csv file.

Example below of output for 3 layer neural network with parameters and biases:

<HDF5 group "/dense_4/dense_4" (2 members)>

<HDF5 dataset "bias:0": shape (12,), type "<f4">
Out[30]:
array([-1.70428085,  0.        ,  1.18814325, -0.19041246, -0.00526408,
        1.40497196, -1.04222631,  0.92191911,  1.008322  ,  1.05576527,
       -1.52697325,  0.        ], dtype=float32)
       
<HDF5 dataset "kernel:0": shape (8, 12), type "<f4">
Out[30]:
array([[  2.79302388e-01,   1.88235305e-02,  -3.92339885e-01,
         -3.41474622e-01,  -5.82196424e-03,  -2.90560424e-01,
          7.42773712e-02,  -2.40337476e-01,  -2.46241421e-01,
         -1.84239745e-01,   2.15733603e-01,  -3.57929952e-02],
       [  8.03584158e-02,  -3.51164229e-02,   2.87301503e-02,
          7.57360235e-02,  -1.33395409e-02,  -6.90313661e-03,
         -5.52563109e-02,  -3.62849087e-02,  -4.34932746e-02,
          1.55740492e-02,   9.74335149e-02,  -1.59938931e-02],
       [ -8.81961882e-02,  -4.93142754e-03,   8.53412822e-02,
          1.98235899e-01,  -8.16800341e-04,   1.53494895e-01,
         -4.47416082e-02,   1.45816416e-01,   1.55644208e-01,
          9.38458219e-02,  -6.26359209e-02,  -4.33534756e-02],
       [  5.59314564e-02,  -1.14197358e-02,   1.19111061e-01,
          1.17240235e-01,  -7.80524220e-03,  -2.51072496e-01,
          2.75643654e-02,  -1.39434174e-01,  -1.49198160e-01,
          9.94404778e-03,  -5.86425066e-02,   2.20275857e-02],
       [ -3.59407775e-02,  -7.78841972e-03,  -5.30055277e-02,
          2.82904878e-03,  -2.66217832e-02,   2.05432680e-02,
          1.19184464e-01,   4.53371704e-02,   4.15279754e-02,
         -3.68780009e-02,  -3.60457115e-02,  -1.14972964e-02],
       [  1.78011805e-01,  -1.86675303e-02,  -1.45264789e-01,
          1.73652485e-01,  -3.91976908e-02,  -2.70790793e-02,
         -2.01461583e-01,  -6.20859675e-02,  -8.74297768e-02,
         -2.21975490e-01,   1.07102073e-03,   1.33957528e-02],
       [  1.20645177e+00,   6.57737255e-03,  -1.22029614e+00,
         -1.51177734e-01,   2.51362417e-02,  -3.38735469e-02,
          6.06300950e-01,  -4.54200387e-01,  -4.40532029e-01,
         -7.21042693e-01,   1.27525878e+00,   1.95977837e-03],
       [ -1.38896316e-01,  -4.49709781e-02,  -1.29760861e-01,
         -3.17691535e-01,   2.14697719e-02,  -2.23892912e-01,
          1.80358887e-01,  -2.86986500e-01,  -2.77976334e-01,
         -9.47473720e-02,   1.37303680e-01,  -8.44306871e-03]], dtype=float32)
         
<HDF5 group "/dense_5/dense_5" (2 members)>

<HDF5 dataset "bias:0": shape (8,), type "<f4">
Out[30]:
array([ 0.        ,  1.48242247, -1.26849794,  1.31229126,  1.38019633,
       -0.02828235, -0.02650108,  1.31731594], dtype=float32)
       
<HDF5 dataset "kernel:0": shape (12, 8), type "<f4">
Out[30]:
array([[  1.71101578e-02,  -1.35540264e-02,   3.77924502e-01,
          7.93520734e-02,  -1.13253556e-02,  -7.80583173e-03,
         -1.14405481e-02,  -6.02411926e-02],
       [ -3.75826843e-02,   4.08672728e-02,   1.23197436e-02,
          3.47535349e-02,  -1.53470151e-02,  -4.85982075e-02,
         -3.78578678e-02,   4.47819568e-02],
       [ -4.00235876e-02,   1.11428469e-01,  -7.86108449e-02,
          1.10252321e-01,   5.95031902e-02,   2.41553015e-03,
          1.93321351e-02,   1.60524890e-01],
       [ -4.60369959e-02,  -4.53457423e-02,   2.60745376e-01,
          6.51171729e-02,   6.42681941e-02,  -3.23704648e-04,
         -4.12408523e-02,   4.32860255e-02],
       [ -4.25389521e-02,   2.89573558e-02,  -1.78456791e-02,
          4.83967476e-02,   2.39968933e-02,   2.91226106e-03,
         -4.49290648e-02,  -2.42232662e-02],
       [ -2.88340207e-02,   6.52579740e-02,  -1.72148198e-01,
         -8.50483552e-02,   1.17551282e-01,  -1.23596024e-02,
         -4.48550917e-02,   3.28231533e-03],
       [ -2.94184685e-02,  -4.90583144e-02,   1.13414869e-01,
         -2.63732374e-01,  -2.59858333e-02,  -1.99310165e-02,
         -4.41738963e-02,  -5.30894287e-02],
       [ -3.85513157e-03,   1.04951654e-02,  -4.04524580e-02,
          1.56890288e-01,   5.60894012e-02,  -6.91699162e-02,
         -1.26265036e-02,   8.78352597e-02],
       [ -7.02880695e-03,   1.27816563e-02,  -7.39284977e-02,
          2.31631145e-01,   1.01949446e-01,  -5.68724237e-02,
         -3.06862146e-02,   4.86681163e-02],
       [ -1.03472471e-02,   2.96425186e-02,   8.73807669e-02,
          2.67850179e-02,   6.10444844e-02,  -1.23008713e-02,
         -6.65493086e-02,   6.04616851e-02],
       [ -4.59223650e-02,  -9.18681920e-03,   6.45521469e-03,
         -1.55365422e-01,  -1.86726660e-01,  -8.35430175e-02,
         -6.49345815e-02,  -1.42037004e-01],
       [  4.04942036e-03,   4.97518294e-02,   6.92932680e-03,
          1.95994265e-02,  -4.20826785e-02,  -2.31025219e-02,
         -2.86299828e-02,   2.99803950e-02]], dtype=float32)
         
<HDF5 group "/dense_6/dense_6" (2 members)>

<HDF5 dataset "bias:0": shape (1,), type "<f4">
Out[30]:
array([-1.18679988], dtype=float32)

<HDF5 dataset "kernel:0": shape (8, 1), type "<f4">
Out[30]:
array([[ -1.67733654e-02],
       [ -6.28030062e-01],
       [  5.09920597e-01],
       [ -5.25723934e-01],
       [ -3.80269229e-01],
       [  1.42359687e-02],
       [  4.09804954e-04],
       [ -4.09353614e-01]], dtype=float32)
